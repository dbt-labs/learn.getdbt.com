---
layout: presentation
title: Docs
estimated_teaching_time: 30
teaching_method: live demo + slides. Questions encouraged.
working_session: true
---

class: title, center, middle
# Docs

---

# Why is documentation important?

_Low quality research manifests as an environment of knowledge cacophony,
where teams only read and trust research that they themselves created._
- Chetan Sharma and Jan Overgoor, [Scaling Knowledge at Airbnb](
https://medium.com/airbnb-engineering/scaling-knowledge-at-airbnb-875d73eff091)

&nbsp;

_If you don't know, now you know._
- Notorious B.I.G., "Juicy"

---

class: subtitle, middle, center
## _How is knowledge documented and maintained at your company?_

---

# Our favorite metaphor

* Analytics engineers are librarians.
* Documentation is the card catalog.
* The goal is to empower analyst-researchers.
--

* _The libarian and the card catalog do not replace each other—they reinforce and enable each other!_

### Analytics is the organization of an organization's information.

---


# Our strong opinions!
.denser-text[
* Code is _surface area_. Testing and documentation are _coverage_.
* Untested, undocumented code _cannot be trusted_. In some sense, it is worse than having no code at all.
* Reliable documentation is _key_ to scaling a data team.¹
* The generation of data documentation should be automated.
* Data documentation should include both:
    * Inferred information from the codebase/database
    * Manual inputs ("this field means that")
* The process to update documentation _must_ be part of the same workflow as the transformations it seeks to describe. If the two are separate, documentation will _always_ lag behind.
]
---

class: subtitle, middle, center

## dbt docs

???
not docs.getdbt.com, though those are also great

---

### Adding descriptions
.dense-text[
Descriptions can be added to models, sources, and columns (in your existing `.yml` files)
]
{% raw %}

.left-column[
.denser-text[

```yml
version: 2

models:
  - name: fct_orders
    description: One record per order
    columns:
      - name: order_id
        tests:
          - unique
          - not_null

      - name: status
        description: "{{ doc('order_status') }}"
        tests:
          - accepted_values:
              values: ['placed', 'shipped', 'completed', 'return_pending', 'returned']

      - name: amount
        description: Amount in USD
```
]
]

.right-column[
.denser-text[

```yml
version: 2

sources:
  - name: jaffle_shop
    description: A replica of the postgres database
    database: raw
    tables:
      - name: orders
        description: One record per order
        columns:
          - name: id
            tests:
              - unique
              - not_null

          - name: status
            description: "{{ doc('order_status') }}"
            tests:
              - accepted_values:
                  values: ['placed', 'shipped', 'completed', 'return_pending', 'returned']

```

]
]

--
.dense-text[
What's the `{{ doc('order_status') }}`?
]

---
### `docs` blocks

`docs` blocks allow you to write long-form descriptions.

Docs blocks are added to `.md` files in your `models/` directory.

.denser-text[
```md
{% docs order_status %}
One of the following values:

| status         | definition                                                 |
|----------------|------------------------------------------------------------|
| placed         | Order placed but not yet shipped                           |
| shipped        | Order has been shipped but hasn't yet been delivered       |
| completed      | Order has been received by customers                       |
| return_pending | Customer has indicated they would like to return this item |
| returned       | Item has been returned                                     |

{% enddocs %}

```
]
{% endraw %}

---
# Generating documentation
.denser-text[
When dbt generates documentation it takes into account:
* Everything it knows about your project:
    * Descriptions (ofc!)
    * Model dependencies
    * Model SQL
    * Sources
    * Tests
* Additional things about your warehouse (from the information schema)
    * Column names and types (even if they aren't documented!)
    * Table stats

This information is used to populate a documentation website.

For example: [dbt Learn demonstration project](https://cloud.getdbt.com/accounts/1951/runs/4352683/docs/#!/overview), [out MRR playbook](https://www.getdbt.com/mrr-playbook/#!/model/model.acme.mrr), [GitLab's dbt project](https://dbt.gitlabdata.com/).
]
---

## dbt CLI
```bash
dbt docs generate
dbt docs serve
```

## dbt Cloud
<img src="/ui/img{{page.id}}/job-config-gen-docs.png" style="width: 90%; float: left;">

---

# What should I document?

.dense-text[
Our rule of thumb: anything that is not immediately obvious.

For example:
* Sources:
    - How the source data came to be in the warehouse
    - Known caveats
    - The definitions of poorly named fields and tables
* Final models:
    - The grain of the model. Potentially a descrition of how the model was built.
    - Column definitions, especially for columns that include business logic
* Intermediate models
    - As required
]
---

class: subtitle

# Knowledge check

You should be able to:
* Add descriptions to your dbt project
* Generate documentation for your project

{% include options/next_presentation.html %}
