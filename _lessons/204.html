---
layout: presentation
title: Best practices
lesson: 201
estimated_teaching_time: 45
estimated_working_session: 0
teaching_method: 15 minutes for recap at start. 30 minutes of one-sided lecture

---
class: title, center, middle
# dbt Best Practices

???
A list of hot-tips that will take your project from good to great!
---
class: subtitle
# dbt code

--

i.e. the code in your `.sql` and `.yml` files
---


## Use our recommended configs
_(Also, you can remove the comments that were generated by the `init` command)_
```yml
# dbt_project.yml
require-dbt-version: "0.15.0"

# snowflake
quoting:
  database: false
  identifier: false
  schema: false

models:
  transient: true

# redshift
models:
  bind: false
```
.caption[
[Example](https://github.com/clrcrl/dbt-learn-ccarroll/blob/master/dbt_project.yml), [Source](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/dbt_project.yml)
]
???

* `require-dbt-version`: will help ensure that everyone is using the same version of dbt, especially important for CLI users
* The others are database specific, we can go into them if required
---
# Ensure you don't have any direct table references
--

🙅‍♀️
```sql
select * from dbt_claire.stg_customers
```
--

🙅‍♀️
{% raw %}
```sql
select * from {{ target.schema }}.stg_customers
```
--

🙆‍♀️
```sql
select * from {{ ref('stg_customers') }}
```
???
* It sounds obvious but people do this all the time!

---
# Ensure you don't have any direct table references
--

🙅‍♀️
```sql
select * from raw.jaffle_shop.customers
```
--

🙆‍♀️
```sql
select * from {{ source('jaffle_shop', 'customers') }}
```
???
Also use sources when referring to raw data
---
# Apply configurations at the group level
--

🙅‍♀️
```sql
-- models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
{{ config(materialized='view')}}
```
```sql
-- models/staging/jaffle_shop/stg_jaffle_shop__orders.sql
{{ config(materialized='view')}}
```
{% endraw %}

---
# Apply configurations at the group level

🙆‍♀️
```yml
models:
  jaffle_shop:
    staging:
        materialized: view

```
???
Makes it easier to change things en-masse
And you structured your project this way, right?
---

# non-dbt code
--

i.e. the code in your repo that dbt doesn't use (but humans do)!


---
# Improve your README

A README can help answer:
- How do I get started with this project?
    * Links to dbt Getting Started instructions
    * Who to contact to get database access
    * Snippets of SQL for a superuser to set up a new user
    * A rough orientation of the project (e.g. which folder does what)

- How can I contribute to this project?
    * Code conventions to follow, e.g. [SQL conventions](https://github.com/fishtown-analytics/corp/blob/master/dbt_coding_conventions.md) and [git conventions](https://github.com/fishtown-analytics/corp/blob/master/git-guide.md)


???
Note: many of these are links to our start project script, so include extra jinja
---
.center[
<img src="/lessons/img/{{page.lesson}}/example-readme.png" style="width: 80%;">
]

.caption[
  [Example](https://github.com/clrcrl/dbt-learn-ccarroll/), [Source](https://github.com/fishtown-analytics/dbt-init/tree/master/starter-project)
]
