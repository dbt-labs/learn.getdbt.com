---
layout: presentation
title: Polish your dbt project
estimated_teaching_time: 45
estimated_working_session: 0
teaching_method: 15 minutes for recap at start. 30 minutes of one-sided lecture

---
class: title, center, middle
# Polish your dbt project

???
A list of hot-tips that will take your project from good to great!
---
class: subtitle
# dbt code

--

i.e. the code in your `.sql` and `.yml` files
---


## Require a dbt version to prevent conflicts
_(Also, you can remove the comments that were generated by the `init` command)_

.dense-text[

```yml
# dbt_project.yml
require-dbt-version: [">=0.16.0", "<0.17.0"]

```

]
.caption[
[Example](https://github.com/clrcrl/dbt-learn-ccarroll/blob/master/dbt_project.yml), [Source](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/dbt_project.yml)
]
???

* `require-dbt-version`: will help ensure that everyone is using the same version of dbt, especially important for CLI users

---
## Ensure you don't have any direct table references
--

üôÖ‚Äç‚ôÄÔ∏è
```sql
select * from dbt_claire.stg_customers
```
--

üôÖ‚Äç‚ôÄÔ∏è
{% raw %}
```sql
select * from {{ target.schema }}.stg_customers
```
--

üôÜ‚Äç‚ôÄÔ∏è
```sql
select * from {{ ref('stg_customers') }}
```
???
* It sounds obvious but people do this all the time!

---
## Ensure you don't have any direct table references
--

üôÖ‚Äç‚ôÄÔ∏è
```sql
select * from raw.jaffle_shop.customers
```
--

üôÜ‚Äç‚ôÄÔ∏è
```sql
select * from {{ source('jaffle_shop', 'customers') }}
```
???
Also use sources when referring to raw data
---
## Apply configurations at the group level
--

üôÖ‚Äç‚ôÄÔ∏è
```sql
-- models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
{{ config(materialized='view')}}
```
```sql
-- models/staging/jaffle_shop/stg_jaffle_shop__orders.sql
{{ config(materialized='view')}}
```
{% endraw %}

---
## Apply configurations at the group level

üôÜ‚Äç‚ôÄÔ∏è
```yml
models:
  jaffle_shop:
    staging:
        materialized: view

```
???
Makes it easier to change things en-masse
And you structured your project this way, right?
---

# non-dbt code
--

i.e. the code in your repo that dbt doesn't use (but humans do)!


---
## Improve your README

A README can help answer:
- How do I get started with this project?
.dense-text[
    * Links to dbt Getting Started instructions
    * Who to contact to get database access
    * Snippets of SQL for a superuser to set up a new user
    * A sample `profiles.yml` file if using the CLI ([example](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/sample.profiles.yml))
    * A rough orientation of the project (e.g. which folder does what)
]
- How can I contribute to this project?
.dense-text[
    * Code conventions to follow, e.g. [SQL conventions](https://github.com/fishtown-analytics/corp/blob/master/dbt_coding_conventions.md) and [git conventions](https://github.com/fishtown-analytics/corp/blob/master/git-guide.md)
]

???
Note: many of these are links to our start project script, so include extra jinja
---
.center[
<img src="/ui/img{{page.id}}/example-readme.png" style="width: 80%;">
]

.caption[
  [Example](https://github.com/clrcrl/dbt-learn-ccarroll/), [Source](https://github.com/fishtown-analytics/dbt-init/tree/master/starter-project)
]
---
## Add a PR template
PR templates help you write better PRs (and are great tools for reviewers!)
* Use headers to prompt someone to fill in the right information
* Checklists are also useful
---
.center[
<img src="/ui/img{{page.id}}/example-pr-template.png" style="width: 80%;">
]

.caption[
  [Example PR template](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/.github/pull_request_template.md)
]
---
class: subtitle, center, middle
# üßò‚Äç‚ôÄÔ∏è [Much better!](https://github.com/fishtown-analytics/dbt-learn-demo/pull/8)

{% include options/next_presentation.html %}
