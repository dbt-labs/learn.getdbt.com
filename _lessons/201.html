---
layout: presentation
title: Polish your dbt project
lesson: 201
estimated_teaching_time: 45
estimated_working_session: 0
teaching_method: 15 minutes for recap at start. 30 minutes of one-sided lecture
---


<!-- just putting this here to prevent a silly jekyll warning at compile time -->


{% raw %}
<!--
To-do:
- Add recap of yesterday
- Add a picture of a good readme/PR template

Notes:
- We originally had {% if target.name == 'dev' %} in here but we haven't learned Jinja yet, so I moved it to 208
-->

# Recap
What we went through yesterday
* [ To do: list of lessons]


???
Allow students to ask any questions
Discuss what the project the teachers have been working on looks like

---
layout: presentation
# Polish your dbt project
## 1. dbt code
## 2. non-dbt code
???
A list of hot-tips that will take your project from good to great!
---

# dbt code

--

i.e. the code in your `.sql` and `.yml` files
---


# Use our recommended configs

```yml
# dbt_project.yml

require-dbt-version: "0.15.0"

# snowflake
quoting:
  database: false
  identifier: false
  schema: false

models:
  transient: true

# redshift
models:
  bind: false


```
* [Source](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/dbt_project.yml)
* Also, you can remove the comments that were generated by the `init` command.
???

* `require-dbt-version`: will help ensure that everyone is using the same version of dbt, especially important for CLI users
* The others are database specific, we can go into them if required
---
# Ensure you don't have any direct table references
--

ğŸ™…â€â™€ï¸
```sql
select * from dbt_claire.stg_customers
```
--

ğŸ™…â€â™€ï¸
```sql
select * from {{ target.schema }}.stg_customers
```
--

ğŸ™†â€â™€ï¸
```sql
select * from {{ ref('stg_customers') }}
```
???
* It sounds obvious but people do this all the time!

---
# Ensure you don't have any direct table references
--

ğŸ™…â€â™€ï¸
```sql
select * from raw.jaffle_shop.customers
```
--

ğŸ™†â€â™€ï¸
```sql
select * from {{ source('jaffle_shop', 'customers') }}
```
???
Also use sources when referring to raw data
---
# Apply configurations at the group level
(where possible)

--

ğŸ™…â€â™€ï¸
```sql
-- models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
{{ config(materialized='view')}}

-- models/staging/jaffle_shop/stg_jaffle_shop__orders.sql
{{ config(materialized='view')}}

-- etc.
```

--

ğŸ™†â€â™€ï¸
```yml
models:
  jaffle_shop:
    staging:
        materialized: view

```
???
Makes it easier to change things en-masse
And you structured your project this way, right?
---

# non-dbt code
--

i.e. the code in your repo that dbt doesn't use (but humans do)!


---
# Improve your README

A README can help answer:
- How do I get started with this project?
    * Links to dbt Getting Started instructions
    * Who to contact to get database access
    * Snippets of SQL for a superuser to set up a new user
    * A sample `profiles.yml` file if using the CLI ([example](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/sample.profiles.yml))
    * A rough orientation of the project (e.g. which folder does what)

- What code conventions should I follow?
    * [SQL conventions](https://github.com/fishtown-analytics/corp/blob/master/dbt_coding_conventions.md)
    * [Git conventions](https://github.com/fishtown-analytics/corp/blob/master/git-guide.md)

[Example](https://github.com/fishtown-analytics/dbt-init/tree/master/starter-project)

???
Note: many of these are links to our start project script, so include extra jinja

---
# Add a PR template
A good PR shows the context of your changes. A PR template helps your write better PRs.
* Use headers to prompt someone to fill in the right information
* Checklists are also useful

[Example](https://github.com/fishtown-analytics/dbt-init/blob/master/starter-project/.github/pull_request_template.md)

---

# Working session
* Implement our recommended configurations for Snowflake
* Remove helper code from `dbt_project.yml`
* Improve your README
* Add a PR template (optional)

???
Only do this exercise if time permits

{% endraw %}
