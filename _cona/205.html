---
layout: presentation
title: Packages and projects
lesson: 203
---

class: title, center, middle
# Packages

---
# What are packages?
--

Packages are dbt projects that you can install in your _own dbt project_

They have:
* A `dbt_project.yml` file
* And contain macros, models etc.


???
Teacher notes:
* We're starting with a very literal example (using macros), and then going to talk more broadly about packages.
Before we hit databases, there's a nice story of "woah that's a package, which is just a dbt project? you know what else has a dbt project? (A: dbt)."
Or, "yo why is there 138 macros in our project when we only added one".
And from there we can talk a little bit about writing custom tests + using custom schemas + custom aliases + custom overviews. Once you get that concept down, it's so easy to understand how you can get dbt to do things you want it to do
---
# Use case: Using macros from a package

1. Add a `packages.yml` file to your project

--

```yml
# packages.yml
packages:
  - package: fishtown-analytics/snowplow
    version: 0.7.1

  - git: "https://github.com/fishtown-analytics/dbt-utils.git"
    revision: 0.1.21

```
???
* Discuss when to use which syntax
---
# Use case: Using macros from a package

1. Add a `packages.yml` file to your project
--

2. Run `dbt deps` to install the package (check out the `modules` dir!)
```shell
$ dbt deps
```
???
* Show the  modules directory
* Note that these are .gitignored
---
# Use case: Using macros from a package

1. Add a `packages.yml` file to your project
2. Run `dbt deps` to install the package
--

3. Access macros from the package
{% raw %}
```sql
-- models/utils/util_days.sql
{{ dbt_utils.date_spine(
    datepart="day",
    start_date="to_date('01/01/2016', 'mm/dd/yyyy')",
    end_date="current_date"
   )
}}
```
{% endraw %}
---
# Use case: Using macros from a package

1. Add a `packages.yml` file to your project
2. Run `dbt deps` to install the package
3. Access macros from the package

```yml
# models/marts/core/schema.yml
version: 2

models:
  - name: orders
    tests:
      - dbt_utils.expression_is_true:
          expression: "order_amount + order_tax = order_total"
```

???
* Go through some of the most common macros in dbt-utils (there might be overlap with previous lesson)
---
# Q: What happens when you add a package with models in it?
--

These models get added to your DAG!

---
background-color: #005E7A
<img src="/lessons/img/{{page.lesson}}/snowplow-package.png" style="width: 100%;">

---
# Use cases for packages:

--

## Macros:
* Versatile macros, especially for “How to Write this in SQL” problems ([dbt-utils](https://hub.getdbt.com/fishtown-analytics/dbt_utils/latest/))
* Ad hoc queries/snippets you find yourself writing over and over ([audit_helper](https://hub.getdbt.com/fishtown-analytics/audit_helper/latest/), [codegen](https://hub.getdbt.com/fishtown-analytics/codegen/latest/))

--

## Models:
* Common staging models for one data source ([facebook](https://hub.getdbt.com/fishtown-analytics/facebook_ads/latest/))
* Follow industry standards for boilerplate-yet-complex modeling ([snowplow](https://hub.getdbt.com/fishtown-analytics/snowplow/latest/), [segment](https://hub.getdbt.com/fishtown-analytics/segment/latest/))
